(()=>{"use strict";const e=window.React,t=window.wp.blocks,a=window.wp.blockEditor,n=window.wp.components,o=window.wp.i18n,r=window.wp.date,l=window.wp.element,d=window.wp.data;(0,t.registerBlockType)("evt/event-date-badge",{title:(0,o.__)("Event Date","events"),icon:"clock",category:"widgets",parent:["evt/event-item"],usesContext:["evt/eventDate"],attributes:{evtBadgeId:{type:"string",default:""},eventDate:{type:"string",default:(()=>{const e=new Date;return(0,r.dateI18n)("Y-m-d",e)})()},isDateSet:{type:"boolean",default:!1},hideYear:{type:"boolean",default:!1},dateBadgeBackgroundColor:{type:"string",default:"#2667FF"},dateBadgeTextColor:{type:"string",default:"#ffffff"},borderBadgeColor:{type:"string",default:"#00000040"},weekdayColor:{type:"string",default:"#000000"}},edit:({attributes:t,setAttributes:s,context:c,clientId:i})=>{const{evtBadgeId:m,eventDate:v,isDateSet:y,hideYear:g,dateBadgeBackgroundColor:u,dateBadgeTextColor:p,borderBadgeColor:w,weekdayColor:E}=t;(0,l.useEffect)(()=>{if(!m){const e=i.substring(0,8);s({evtBadgeId:e})}},[]);const b=c["evt/eventDate"]||v,f=(0,d.useSelect)(e=>{const{getBlockParents:t,getBlock:a}=e("core/block-editor"),n=t(i);for(let e of n){const t=a(e);if(t&&"evt/event-item"===t.name)return e}return null},[i]);(0,l.useEffect)(()=>{c["evt/eventDate"]&&c["evt/eventDate"]!==v&&s({eventDate:c["evt/eventDate"]})},[c["evt/eventDate"]]),(0,l.useEffect)(()=>{if(!m)return;const e=document.getElementById(`evt-badge-style-${m}`);e&&e.remove();const t=document.createElement("style");return t.id=`evt-badge-style-${m}`,t.innerHTML=`\n\t\t\t\t.evt-badge-${m} .evt-border-badge {\n\t\t\t\t\tborder: 1px solid ${w};\n\t\t\t\t}\n\t\t\t\t.evt-badge-${m} .evt-event-date-badge {\n\t\t\t\t\tbackground-color: ${u};\n\t\t\t\t\tcolor: ${p};\n\t\t\t\t}\n\t\t\t\t.evt-badge-${m} .evt-date-day,\n\t\t\t\t.evt-badge-${m} .evt-date-month {\n\t\t\t\t\tcolor: ${p};\n\t\t\t\t}\n\t\t\t\t.evt-badge-${m} .evt-date-weekday {\n\t\t\t\t\tcolor: ${E};\n\t\t\t\t}\n\t\t\t`,document.head.appendChild(t),()=>{const e=document.getElementById(`evt-badge-style-${m}`);e&&e.remove()}},[m,u,p,w,E]);const h=(0,a.useBlockProps)({className:"evt-event-date-badge-container"+(m?` evt-badge-${m}`:"")}),k=(e=>{if(!e)return{day:"01",month:"Jan",year:"0001",weekday:"MON"};try{const t=new Date(e);return{day:(0,r.dateI18n)("d",t),month:(0,r.dateI18n)("M",t),year:(0,r.dateI18n)("Y",t),weekday:(0,r.dateI18n)("D",t).toUpperCase()}}catch(e){return{day:"01",month:"Jan",year:"0001",weekday:"MON"}}})(b);return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(a.InspectorControls,null,(0,e.createElement)(n.PanelBody,{className:"evt-date-settings",title:(0,o.__)("Date Settings","events")},(0,e.createElement)("div",{style:{marginBottom:"15px"}},(0,e.createElement)("strong",null,(0,o.__)("Event Date","events")),(0,e.createElement)(n.DateTimePicker,{currentDate:b,onChange:e=>{s({eventDate:e,isDateSet:!0}),f&&(0,d.dispatch)("core/block-editor").updateBlockAttributes(f,{eventDate:e})},is12Hour:!0})),(0,e.createElement)("p",{style:{fontSize:"13px",color:"#FF0000",marginBottom:"10px"}},(0,e.createElement)("strong",null,(0,o.__)("Note:","events"))," ",(0,o.__)("To hide the year, simply set the year value to 0001 in the year section.","events"))),(0,e.createElement)(n.PanelBody,{title:(0,o.__)("Date Colors","events"),initialOpen:!1},(0,e.createElement)(n.PanelRow,null,(0,e.createElement)("div",{style:{width:"100%",marginTop:"16px"}},(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"}},(0,o.__)("Background Color","events")),(0,e.createElement)(a.ColorPalette,{value:u,onChange:e=>s({dateBadgeBackgroundColor:e||"#2667FF"})}))),(0,e.createElement)(n.PanelRow,null,(0,e.createElement)("div",{style:{width:"100%",marginTop:"16px"}},(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"}},(0,o.__)("Text Color","events")),(0,e.createElement)(a.ColorPalette,{value:p,onChange:e=>s({dateBadgeTextColor:e||"#ffffff"})}))),(0,e.createElement)(n.PanelRow,null,(0,e.createElement)("div",{style:{width:"100%",marginTop:"16px"}},(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"}},(0,o.__)("Border Color","events")),(0,e.createElement)(a.ColorPalette,{value:w,onChange:e=>s({borderBadgeColor:e||"#00000040"})}))),(0,e.createElement)(n.PanelRow,null,(0,e.createElement)("div",{style:{width:"100%",marginTop:"16px"}},(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"}},(0,o.__)("Weekday Color","events")),(0,e.createElement)(a.ColorPalette,{value:E,onChange:e=>s({weekdayColor:e||"#000000"})}))))),(0,e.createElement)("div",{...h},(0,e.createElement)("div",{className:"evt-border-badge"},(0,e.createElement)("div",{className:"evt-event-date-badge"},(0,e.createElement)("span",{className:"evt-date-day"},k.day),(0,e.createElement)("span",{className:"evt-date-month"},k.month),!g&&"0001"!==k.year&&(0,e.createElement)("span",{className:"evt-date-year"},k.year))),(0,e.createElement)("span",{className:"evt-date-weekday"},k.weekday)))},save:({attributes:t})=>{const{evtBadgeId:n,eventDate:o,isDateSet:l,hideYear:d}=t,s=a.useBlockProps.save({className:"evt-event-date-badge-container"+(n?` evt-badge-${n}`:"")}),c=(e=>{if(!e)return{day:"01",month:"Jan",year:"0001",weekday:"MON"};try{const t=new Date(e);return{day:(0,r.dateI18n)("d",t),month:(0,r.dateI18n)("M",t),year:(0,r.dateI18n)("Y",t),weekday:(0,r.dateI18n)("D",t).toUpperCase()}}catch(e){return{day:"01",month:"Jan",year:"0001",weekday:"MON"}}})(o);return(0,e.createElement)("div",{...s},(0,e.createElement)("div",{className:"evt-border-badge"},(0,e.createElement)("div",{className:"evt-event-date-badge"},(0,e.createElement)("span",{className:"evt-date-day"},c.day),(0,e.createElement)("span",{className:"evt-date-month"},c.month),!d&&"0001"!==c.year&&(0,e.createElement)("span",{className:"evt-date-year"},c.year))),(0,e.createElement)("span",{className:"evt-date-weekday"},c.weekday))}})})();