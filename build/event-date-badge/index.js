(()=>{"use strict";const e=window.wp.blocks,t=window.wp.blockEditor,a=window.wp.components,n=window.wp.element,d=window.wp.data,s=window.wp.date,o=window.wp.i18n,r=window.ReactJSXRuntime,l=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"evt/event-date-badge","version":"0.1.0","title":"Event Date","category":"widgets","icon":"clock","description":"Event Date Badge","textdomain":"events","parent":["evt/event-item"],"usesContext":["evt/eventDate"],"attributes":{"evtBadgeId":{"type":"string","default":""},"eventDate":{"type":"string"},"isDateSet":{"type":"boolean","default":false},"hideYear":{"type":"boolean","default":false},"dateBadgeBackgroundColor":{"type":"string","default":"#2667FF"},"dateBadgeTextColor":{"type":"string","default":"#ffffff"},"borderBadgeColor":{"type":"string","default":"#00000040"},"weekdayColor":{"type":"string","default":"#000000"}},"editorScript":"file:./index.js"}');(0,e.registerBlockType)(l.name,{...l,edit:function({attributes:e,setAttributes:l,context:i,clientId:c}){const{evtBadgeId:v,eventDate:g,hideYear:y,dateBadgeBackgroundColor:h,dateBadgeTextColor:p,borderBadgeColor:m,weekdayColor:x}=e;(0,n.useEffect)(()=>{if(!v){const e=c.substring(0,8);l({evtBadgeId:e})}},[]);const u=i["evt/eventDate"]||g,w=(0,d.useSelect)(e=>{const{getBlockParents:t,getBlock:a}=e("core/block-editor"),n=t(c);for(let e of n){const t=a(e);if(t&&"evt/event-item"===t.name)return e}return null},[c]);(0,n.useEffect)(()=>{i["evt/eventDate"]&&i["evt/eventDate"]!==g&&l({eventDate:i["evt/eventDate"]})},[i["evt/eventDate"]]),(0,n.useEffect)(()=>{if(!v)return;const e=document.getElementById(`evt-badge-style-${v}`);e&&e.remove();const t=document.createElement("style");return t.id=`evt-badge-style-${v}`,t.innerHTML=`\n\t\t\t.evt-badge-${v} .evt-border-badge {\n\t\t\t\tborder: 1px solid ${m};\n\t\t\t}\n\t\t\t.evt-badge-${v} .evt-event-date-badge {\n\t\t\t\tbackground-color: ${h};\n\t\t\t\tcolor: ${p};\n\t\t\t}\n\t\t\t.evt-badge-${v} .evt-date-day,\n\t\t\t.evt-badge-${v} .evt-date-month {\n\t\t\t\tcolor: ${p};\n\t\t\t}\n\t\t\t.evt-badge-${v} .evt-date-weekday {\n\t\t\t\tcolor: ${x};\n\t\t\t}\n\t\t`,document.head.appendChild(t),()=>{const e=document.getElementById(`evt-badge-style-${v}`);e&&e.remove()}},[v,h,p,m,x]);const b=(0,t.useBlockProps)({className:"evt-event-date-badge-container"+(v?` evt-badge-${v}`:"")}),f=(e=>{if(!e)return{day:"01",month:"Jan",year:"0001",weekday:"MON"};try{const t=new Date(e);return{day:(0,s.dateI18n)("d",t),month:(0,s.dateI18n)("M",t),year:(0,s.dateI18n)("Y",t),weekday:(0,s.dateI18n)("D",t).toUpperCase()}}catch(e){return{day:"01",month:"Jan",year:"0001",weekday:"MON"}}})(u);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(t.InspectorControls,{children:[(0,r.jsxs)(a.PanelBody,{className:"evt-date-settings",title:(0,o.__)("Date Settings","events"),children:[(0,r.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,r.jsx)("strong",{children:(0,o.__)("Event Date","events")}),(0,r.jsx)(a.DateTimePicker,{currentDate:u,onChange:e=>{l({eventDate:e,isDateSet:!0}),w&&(0,d.dispatch)("core/block-editor").updateBlockAttributes(w,{eventDate:e})},is12Hour:!0})]}),(0,r.jsxs)("p",{style:{fontSize:"13px",color:"#FF0000",marginBottom:"10px"},children:[(0,r.jsx)("strong",{children:(0,o.__)("Note:","events")})," ",(0,o.__)("To hide the year, simply set the year value to 0001 in the year section.","events")]})]}),(0,r.jsxs)(a.PanelBody,{title:(0,o.__)("Date Colors","events"),initialOpen:!1,children:[(0,r.jsx)(a.PanelRow,{children:(0,r.jsxs)("div",{style:{width:"100%",marginTop:"16px"},children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:(0,o.__)("Background Color","events")}),(0,r.jsx)(t.ColorPalette,{value:h,onChange:e=>l({dateBadgeBackgroundColor:e||"#2667FF"})})]})}),(0,r.jsx)(a.PanelRow,{children:(0,r.jsxs)("div",{style:{width:"100%",marginTop:"16px"},children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:(0,o.__)("Text Color","events")}),(0,r.jsx)(t.ColorPalette,{value:p,onChange:e=>l({dateBadgeTextColor:e||"#ffffff"})})]})}),(0,r.jsx)(a.PanelRow,{children:(0,r.jsxs)("div",{style:{width:"100%",marginTop:"16px"},children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:(0,o.__)("Border Color","events")}),(0,r.jsx)(t.ColorPalette,{value:m,onChange:e=>l({borderBadgeColor:e||"#00000040"})})]})}),(0,r.jsx)(a.PanelRow,{children:(0,r.jsxs)("div",{style:{width:"100%",marginTop:"16px"},children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:(0,o.__)("Weekday Color","events")}),(0,r.jsx)(t.ColorPalette,{value:x,onChange:e=>l({weekdayColor:e||"#000000"})})]})})]})]}),(0,r.jsxs)("div",{...b,children:[(0,r.jsx)("div",{className:"evt-border-badge",children:(0,r.jsxs)("div",{className:"evt-event-date-badge",children:[(0,r.jsx)("span",{className:"evt-date-day",children:f.day}),(0,r.jsx)("span",{className:"evt-date-month",children:f.month}),!y&&"0001"!==f.year&&(0,r.jsx)("span",{className:"evt-date-year",children:f.year})]})}),(0,r.jsx)("span",{className:"evt-date-weekday",children:f.weekday})]})]})},save:function({attributes:e}){const{evtBadgeId:a,eventDate:n,hideYear:d}=e,o=t.useBlockProps.save({className:"evt-event-date-badge-container"+(a?` evt-badge-${a}`:"")}),l=(e=>{if(!e)return{day:"01",month:"Jan",year:"0001",weekday:"MON"};try{const t=new Date(e);return{day:(0,s.dateI18n)("d",t),month:(0,s.dateI18n)("M",t),year:(0,s.dateI18n)("Y",t),weekday:(0,s.dateI18n)("D",t).toUpperCase()}}catch(e){return{day:"01",month:"Jan",year:"0001",weekday:"MON"}}})(n);return(0,r.jsxs)("div",{...o,children:[(0,r.jsx)("div",{className:"evt-border-badge",children:(0,r.jsxs)("div",{className:"evt-event-date-badge",children:[(0,r.jsx)("span",{className:"evt-date-day",children:l.day}),(0,r.jsx)("span",{className:"evt-date-month",children:l.month}),!d&&"0001"!==l.year&&(0,r.jsx)("span",{className:"evt-date-year",children:l.year})]})}),(0,r.jsx)("span",{className:"evt-date-weekday",children:l.weekday})]})}})})();