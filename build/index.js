(()=>{"use strict";const e=window.wp.blocks,t=window.wp.blockEditor,a=window.wp.components,n=window.wp.i18n,r=window.wp.date,o=window.wp.element,l=window.wp.data,c=window.wp.hooks,s=window.wp.compose,i=()=>{const e=new Date;return(0,r.dateI18n)("Y-m-d",e)},d=e=>{if(!e)return"";const[t,a]=e.split(":");let n=parseInt(t);const r=n>=12?"PM":"AM";return n%=12,n=n||12,`${n}:${a} ${r}`};(0,e.registerBlockType)("evt/events-grid",{title:(0,n.__)("Events","events"),icon:"grid-view",category:"widgets",attributes:{columns:{type:"number",default:2}},edit:({attributes:e,setAttributes:r})=>{const{columns:l}=e,c=(0,t.useBlockProps)({className:"evt-events-grid-container",style:{"--grid-columns":l}}),s=window.evtPluginData&&window.evtPluginData.images?[window.evtPluginData.images.crazyDJ||"",window.evtPluginData.images.rockBand||"",window.evtPluginData.images.foodDistribution||""]:["","",""];return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(t.InspectorControls,null,(0,o.createElement)(a.PanelBody,{title:(0,n.__)("Grid Settings","events")},(0,o.createElement)(a.__experimentalNumberControl,{label:(0,n.__)("Columns","events"),value:l,onChange:e=>r({columns:parseInt(e)||2}),min:1,max:3,help:(0,n.__)("Number of columns in the grid (1-3)","evt"),__next40pxDefaultSize:!0}))),(0,o.createElement)("div",{...c},(0,o.createElement)(t.InnerBlocks,{allowedBlocks:["evt/event-item"],template:[["evt/event-item",{eventImage:s[0],eventImageAlt:"Crazy DJ Experience Santa Cruz",eventDate:"2026-01-06",isDefault:!0,hasImage:!0}],["evt/event-item",{eventImage:s[1],eventImageAlt:"Cute Girls Rock Band Performance",eventDate:"2026-04-04",isDefault:!0,hasImage:!0}],["evt/event-item",{eventImage:s[2],eventImageAlt:"Free Food Distribution At Mumbai",eventDate:"2026-06-08",isDefault:!0,hasImage:!0}]],renderAppender:()=>(0,o.createElement)(t.InnerBlocks.ButtonBlockAppender,null)})))},save:({attributes:e})=>{const{columns:a}=e,n=t.useBlockProps.save({className:"evt-events-grid-container evt-front-view",style:{"--columns":a}});return(0,o.createElement)("div",{...n},(0,o.createElement)(t.InnerBlocks.Content,null))}}),(0,e.registerBlockType)("evt/event-date-badge",{title:(0,n.__)("Event Date","events"),icon:"clock",category:"widgets",parent:["evt/event-item"],usesContext:["evt/eventDate"],attributes:{evtBadgeId:{type:"string",default:""},eventDate:{type:"string",default:i()},isDateSet:{type:"boolean",default:!1},hideYear:{type:"boolean",default:!1},dateBadgeBackgroundColor:{type:"string",default:"#2667FF"},dateBadgeTextColor:{type:"string",default:"#ffffff"},borderBadgeColor:{type:"string",default:"#00000040"},weekdayColor:{type:"string",default:"#000000"}},edit:({attributes:e,setAttributes:c,context:s,clientId:i})=>{const{evtBadgeId:d,eventDate:m,isDateSet:v,hideYear:u,dateBadgeBackgroundColor:g,dateBadgeTextColor:p,borderBadgeColor:b,weekdayColor:y}=e;(0,o.useEffect)(()=>{if(!d){const e=i.substring(0,8);c({evtBadgeId:e})}},[]);const k=s["evt/eventDate"]||m,E=(0,l.useSelect)(e=>{const{getBlockParents:t,getBlock:a}=e("core/block-editor"),n=t(i);for(let e of n){const t=a(e);if(t&&"evt/event-item"===t.name)return e}return null},[i]);(0,o.useEffect)(()=>{s["evt/eventDate"]&&s["evt/eventDate"]!==m&&c({eventDate:s["evt/eventDate"]})},[s["evt/eventDate"]]),(0,o.useEffect)(()=>{if(!d)return;const e=document.getElementById(`evt-badge-style-${d}`);e&&e.remove();const t=document.createElement("style");return t.id=`evt-badge-style-${d}`,t.innerHTML=`\n\t\t\t\t.evt-badge-${d} .evt-border-badge {\n\t\t\t\t\tborder: 1px solid ${b};\n\t\t\t\t}\n\t\t\t\t.evt-badge-${d} .evt-event-date-badge {\n\t\t\t\t\tbackground-color: ${g};\n\t\t\t\t\tcolor: ${p};\n\t\t\t\t}\n\t\t\t\t.evt-badge-${d} .evt-date-day,\n\t\t\t\t.evt-badge-${d} .evt-date-month {\n\t\t\t\t\tcolor: ${p};\n\t\t\t\t}\n\t\t\t\t.evt-badge-${d} .evt-date-weekday {\n\t\t\t\t\tcolor: ${y};\n\t\t\t\t}\n\t\t\t`,document.head.appendChild(t),()=>{const e=document.getElementById(`evt-badge-style-${d}`);e&&e.remove()}},[d,g,p,b,y]);const f=(0,t.useBlockProps)({className:"evt-event-date-badge-container"+(d?` evt-badge-${d}`:"")}),B=(e=>{if(!e)return{day:"01",month:"Jan",year:"0001",weekday:"MON"};try{const t=new Date(e);return{day:(0,r.dateI18n)("d",t),month:(0,r.dateI18n)("M",t),year:(0,r.dateI18n)("Y",t),weekday:(0,r.dateI18n)("D",t).toUpperCase()}}catch(e){return{day:"01",month:"Jan",year:"0001",weekday:"MON"}}})(k);return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(t.InspectorControls,null,(0,o.createElement)(a.PanelBody,{className:"evt-date-settings",title:(0,n.__)("Date Settings","events")},(0,o.createElement)("div",{style:{marginBottom:"15px"}},(0,o.createElement)("strong",null,(0,n.__)("Event Date","events")),(0,o.createElement)(a.DateTimePicker,{currentDate:k,onChange:e=>{c({eventDate:e,isDateSet:!0}),E&&(0,l.dispatch)("core/block-editor").updateBlockAttributes(E,{eventDate:e})},is12Hour:!0})),(0,o.createElement)("p",{style:{fontSize:"13px",color:"#FF0000",marginBottom:"10px"}},(0,o.createElement)("strong",null,(0,n.__)("Note:","events"))," ",(0,n.__)("If you do not want to display the year, please remove the value from the year section.","events"))),(0,o.createElement)(a.PanelBody,{title:(0,n.__)("Date Colors","events"),initialOpen:!1},(0,o.createElement)(a.PanelRow,null,(0,o.createElement)("div",{style:{width:"100%",marginTop:"16px"}},(0,o.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"}},(0,n.__)("Background Color","events")),(0,o.createElement)(t.ColorPalette,{value:g,onChange:e=>c({dateBadgeBackgroundColor:e||"#2667FF"})}))),(0,o.createElement)(a.PanelRow,null,(0,o.createElement)("div",{style:{width:"100%",marginTop:"16px"}},(0,o.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"}},(0,n.__)("Text Color","events")),(0,o.createElement)(t.ColorPalette,{value:p,onChange:e=>c({dateBadgeTextColor:e||"#ffffff"})}))),(0,o.createElement)(a.PanelRow,null,(0,o.createElement)("div",{style:{width:"100%",marginTop:"16px"}},(0,o.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"}},(0,n.__)("Border Color","events")),(0,o.createElement)(t.ColorPalette,{value:b,onChange:e=>c({borderBadgeColor:e||"#00000040"})}))),(0,o.createElement)(a.PanelRow,null,(0,o.createElement)("div",{style:{width:"100%",marginTop:"16px"}},(0,o.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"}},(0,n.__)("Weekday Color","events")),(0,o.createElement)(t.ColorPalette,{value:y,onChange:e=>c({weekdayColor:e||"#000000"})}))))),(0,o.createElement)("div",{...f},(0,o.createElement)("div",{className:"evt-border-badge"},(0,o.createElement)("div",{className:"evt-event-date-badge"},(0,o.createElement)("span",{className:"evt-date-day"},B.day),(0,o.createElement)("span",{className:"evt-date-month"},B.month),!u&&"0001"!==B.year&&(0,o.createElement)("span",{className:"evt-date-year"},B.year))),(0,o.createElement)("span",{className:"evt-date-weekday"},B.weekday)))},save:({attributes:e})=>{const{evtBadgeId:a,eventDate:n,isDateSet:l,hideYear:c}=e,s=t.useBlockProps.save({className:"evt-event-date-badge-container"+(a?` evt-badge-${a}`:"")}),i=(e=>{if(!e)return{day:"01",month:"Jan",year:"0001",weekday:"MON"};try{const t=new Date(e);return{day:(0,r.dateI18n)("d",t),month:(0,r.dateI18n)("M",t),year:(0,r.dateI18n)("Y",t),weekday:(0,r.dateI18n)("D",t).toUpperCase()}}catch(e){return{day:"01",month:"Jan",year:"0001",weekday:"MON"}}})(n);return(0,o.createElement)("div",{...s},(0,o.createElement)("div",{className:"evt-border-badge"},(0,o.createElement)("div",{className:"evt-event-date-badge"},(0,o.createElement)("span",{className:"evt-date-day"},i.day),(0,o.createElement)("span",{className:"evt-date-month"},i.month),!c&&"0001"!==i.year&&(0,o.createElement)("span",{className:"evt-date-year"},i.year))),(0,o.createElement)("span",{className:"evt-date-weekday"},i.weekday))}}),(0,e.registerBlockType)("evt/event-item",{title:(0,n.__)("Event Item","events"),icon:"calendar",category:"widgets",parent:["evt/events-grid"],providesContext:{"evt/eventDate":"eventDate","evt/eventStartTime":"eventStartTime","evt/eventEndTime":"eventEndTime"},attributes:{evtBlockId:{type:"string",default:""},eventImage:{type:"string",default:""},eventImageAlt:{type:"string",default:""},eventDate:{type:"string",default:i()},eventStartTime:{type:"string",default:"09:00"},eventEndTime:{type:"string",default:"17:00"},detailsBackgroundColor:{type:"string",default:"#ffffff"},isDefault:{type:"boolean",default:!1},hasImage:{type:"boolean",default:!1},mediaBlock:{type:"boolean",default:!1}},edit:({attributes:r,setAttributes:c,clientId:s})=>{const{evtBlockId:i,eventImage:m,eventImageAlt:v,eventDate:u,eventStartTime:g,eventEndTime:p,detailsBackgroundColor:b,isDefault:y,hasImage:k,mediaBlock:E}=r;(0,o.useEffect)(()=>{if(!i){const e=s.substring(0,8);c({evtBlockId:e})}},[]),(0,o.useEffect)(()=>{if(!i)return;const e=document.getElementById(`evt-block-style-${i}`);e&&e.remove();const t=document.createElement("style");return t.id=`evt-block-style-${i}`,t.innerHTML=`\n\t\t\t\t.evt-block-${i} .evt-event-details {\n\t\t\t\t\tbackground-color: ${b};\n\t\t\t\t}\n\t\t\t`,document.head.appendChild(t),()=>{const e=document.getElementById(`evt-block-style-${i}`);e&&e.remove()}},[i,b]);const f=(0,l.useSelect)(e=>{const t=e("core/block-editor").getBlock(s)?.innerBlocks||[];if(t.find(e=>"core/image"===e.name))return!0;const a=t.find(e=>"core/group"===e.name&&e.attributes?.className?.includes("evt-event-image-wrap"));return!!(a&&a.innerBlocks&&a.innerBlocks.find(e=>"core/image"===e.name))},[s]),B=t=>{if(t){const t=(0,e.createBlock)("core/group",{className:"evt-event-image-wrap"},[(0,e.createBlock)("core/image",{className:"evt-event-image-block"})]);(0,l.dispatch)("core/block-editor").insertBlocks(t,0,s),c({mediaBlock:!0,hasImage:!0}),setTimeout(()=>{const e=((0,l.select)("core/block-editor").getBlock(s)?.innerBlocks||[])[0];e&&e.innerBlocks&&e.innerBlocks[0]&&(0,l.dispatch)("core/block-editor").selectBlock(e.innerBlocks[0].clientId)},50)}else{const e=(0,l.select)("core/block-editor").getBlock(s)?.innerBlocks||[],t=e.find(e=>"core/group"===e.name&&e.attributes?.className?.includes("evt-event-image-wrap"));if(t)(0,l.dispatch)("core/block-editor").removeBlock(t.clientId);else{const t=e.find(e=>"core/image"===e.name);t&&(0,l.dispatch)("core/block-editor").removeBlock(t.clientId)}c({mediaBlock:!1,eventImage:"",eventImageAlt:"",hasImage:!1})}},h=(0,t.useBlockProps)({className:"evt-event-item"+(i?` evt-block-${i}`:"")}),w=[{title:"Crazy DJ Experience Santa Cruz",time:"9:00 AM - 5:00 PM",location:"JW Marriott, Sector 35",price:"$25.00"},{title:"Cute Girls Rock Band Performance",time:"9:00 AM - 5:00 PM",location:"Club XYZ, Sector 17",price:"$20.00"},{title:"Free Food Distribution At Mumbai",time:"9:00 AM - 5:00 PM",location:"Food Corp. Mumbai, Ft. Line",price:"No Cost"}],I=y?v.includes("DJ")?w[0]:v.includes("Rock")?w[1]:v.includes("Food")?w[2]:null:null,N=`${d(g)} – ${d(p)}`,_=y&&I?[["core/group",{className:"evt-event-image-wrap"},[["core/image",{url:m,alt:v,className:"evt-event-image-block"}]]],["core/group",{className:"evt-card-details"},[["evt/event-date-badge",{eventDate:u,isDateSet:!0}],["core/group",{className:"evt-event-detail"},[["core/paragraph",{className:"evt-event-time",content:N,evtStartTime:g,evtEndTime:p,evtIsTimeSet:!0}],["core/heading",{level:4,className:"evt-event-title",content:I?.title||""}],["core/paragraph",{placeholder:(0,n.__)("Event Description","events"),className:"evt-event-description"}],["core/paragraph",{className:"evt-event-location",content:I?.location||""}],["core/group",{className:"evt-price-read-more"},[["core/paragraph",{className:"evt-event-price",content:I?.price||""}],["core/buttons",{},[["core/button",{text:"Read More",className:"evt-event-read-more",url:""}]]]]]]]]]]:[["core/group",{className:"evt-event-image-wrap"},[["core/image",{className:"evt-event-image-block"}]]],["core/group",{className:"evt-card-details"},[["evt/event-date-badge",{eventDate:u,isDateSet:!1}],["core/group",{className:"evt-event-detail"},[["core/paragraph",{placeholder:(0,n.__)("9:00 AM – 5:00 PM","events"),className:"evt-event-time",evtStartTime:g,evtEndTime:p,evtIsTimeSet:!1}],["core/heading",{level:4,placeholder:(0,n.__)("Event Title","events"),className:"evt-event-title"}],["core/paragraph",{placeholder:(0,n.__)("Event Description","events"),className:"evt-event-description"}],["core/paragraph",{placeholder:(0,n.__)("Event Location","events"),className:"evt-event-location"}],["core/group",{className:"evt-price-read-more"},[["core/paragraph",{placeholder:(0,n.__)("Event Price","events"),className:"evt-event-price"}],["core/buttons",{},[["core/button",{text:(0,n.__)("Read More","events"),className:"evt-event-read-more",url:""}]]]]]]]]]];return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(t.InspectorControls,null,(0,o.createElement)(a.PanelBody,{title:(0,n.__)("Event Settings","events")},(0,o.createElement)(a.PanelRow,null,(0,o.createElement)("div",{style:{width:"100%",marginTop:"16px"}},(0,o.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"}},(0,n.__)("Details Background Color","events")),(0,o.createElement)(t.ColorPalette,{value:b,onChange:e=>c({detailsBackgroundColor:e||"#ffffff"})}))))),(0,o.createElement)("div",{...h},(0,o.createElement)("div",{className:"evt-event-card"},!f&&(0,o.createElement)("div",{className:"evt-add-image-block"},(0,o.createElement)(a.Button,{isSmall:!0,isSecondary:!0,onClick:()=>B(!0)},(0,n.__)("Add Image Block","events"))),f&&(0,o.createElement)("div",{className:"evt-add-image-block"},(0,o.createElement)(a.Button,{isSmall:!0,isSecondary:!0,onClick:()=>B(!1)},(0,n.__)("Remove Image Block","events"))),(0,o.createElement)("div",{className:"evt-event-details"},(0,o.createElement)("div",{className:"evt-event-details-inner"},(0,o.createElement)(t.InnerBlocks,{template:_,templateLock:!1,allowedBlocks:["core/group","core/image","evt/event-date-badge","core/heading","core/paragraph","core/list","core/buttons","core/button"]}))))))},save:({attributes:e})=>{const{evtBlockId:a}=e,n=t.useBlockProps.save({className:"evt-event-item"+(a?` evt-block-${a}`:"")});return(0,o.createElement)("div",{...n},(0,o.createElement)("div",{className:"evt-event-card"},(0,o.createElement)("div",{className:"evt-event-details"},(0,o.createElement)("div",{className:"evt-event-details-inner"},(0,o.createElement)(t.InnerBlocks.Content,null)))))}}),(0,c.addFilter)("blocks.registerBlockType","evt/paragraph-time-attributes",(e,t)=>"core/paragraph"!==t?e:{...e,attributes:{...e.attributes,evtStartTime:{type:"string",default:"09:00"},evtEndTime:{type:"string",default:"17:00"},evtIsTimeSet:{type:"boolean",default:!1}}});const m=(0,s.createHigherOrderComponent)(e=>r=>{const{attributes:c,setAttributes:s,name:i}=r;if("core/paragraph"!==i||!c.className||!c.className.includes("evt-event-time"))return(0,o.createElement)(e,r);const{evtStartTime:m,evtEndTime:v,evtIsTimeSet:u}=c,g=(0,l.useSelect)(e=>{const{getBlockParents:t,getBlock:a}=e("core/block-editor"),n=t(r.clientId);for(let e of n){const t=a(e);if(t&&"evt/event-item"===t.name)return{clientId:e,startTime:t.attributes.eventStartTime||"09:00",endTime:t.attributes.eventEndTime||"17:00"}}return null},[r.clientId]),p=g?.startTime||m,b=g?.endTime||v,y=(e,t)=>{const a=`${d(e)} – ${d(t)}`;s({content:a})};return(0,o.useEffect)(()=>{g&&u&&y(p,b)},[g?.startTime,g?.endTime]),(0,o.createElement)(o.Fragment,{},(0,o.createElement)(e,r),(0,o.createElement)(t.InspectorControls,{},(0,o.createElement)(a.PanelBody,{title:(0,n.__)("Time Settings","events"),className:"evt-time-settings"},(0,o.createElement)("div",{style:{marginBottom:"15px"}},(0,o.createElement)("strong",{},(0,n.__)("Start Time","events")),(0,o.createElement)("input",{type:"time",value:p,onChange:e=>{return t=e.target.value,s({evtStartTime:t,evtIsTimeSet:!0}),g&&(0,l.dispatch)("core/block-editor").updateBlockAttributes(g.clientId,{eventStartTime:t}),void y(t,b);var t},style:{width:"100%",padding:"8px",marginTop:"8px",border:"1px solid #ddd",borderRadius:"4px"}})),(0,o.createElement)("div",{style:{marginBottom:"15px"}},(0,o.createElement)("strong",{},(0,n.__)("End Time","events")),(0,o.createElement)("input",{type:"time",value:b,onChange:e=>{return t=e.target.value,s({evtEndTime:t,evtIsTimeSet:!0}),g&&(0,l.dispatch)("core/block-editor").updateBlockAttributes(g.clientId,{eventEndTime:t}),void y(p,t);var t},style:{width:"100%",padding:"8px",marginTop:"8px",border:"1px solid #ddd",borderRadius:"4px"}})))))},"withTimeSettings");(0,c.addFilter)("editor.BlockEdit","evt/paragraph-time-settings",m)})();