(()=>{"use strict";const e=window.React,t=window.wp.blocks,a=window.wp.blockEditor,n=window.wp.components,r=window.wp.i18n,o=window.wp.date,l=()=>{const e=new Date;return(0,o.dateI18n)("Y-m-d",e)},c=e=>{if(!e)return"";const[t,a]=e.split(":");let n=parseInt(t);const r=n>=12?"PM":"AM";return n%=12,n=n||12,`${n}:${a} ${r}`},s=JSON.parse('{"UU":"evtb/events-grid"}');(0,t.registerBlockType)(s.UU,{edit:({attributes:t,setAttributes:o})=>{const{columns:l}=t,c=(0,a.useBlockProps)({className:"evtb-events-grid-container",style:{"--grid-columns":l}}),s=window.evtbPluginData&&window.evtbPluginData.images?[window.evtbPluginData.images.crazyDJ||"",window.evtbPluginData.images.rockBand||"",window.evtbPluginData.images.foodDistribution||""]:["","",""];return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(a.InspectorControls,null,(0,e.createElement)(n.PanelBody,{title:(0,r.__)("Grid Settings","events")},(0,e.createElement)(n.__experimentalNumberControl,{label:(0,r.__)("Columns","events"),value:l,onChange:e=>o({columns:parseInt(e)||2}),min:1,max:3,help:(0,r.__)("Number of columns in the grid (1-3)","evtb"),__next40pxDefaultSize:!0}))),(0,e.createElement)("div",{...c},(0,e.createElement)(a.InnerBlocks,{allowedBlocks:["evtb/event-item"],template:[["evtb/event-item",{eventImage:s[0],eventImageAlt:"Crazy DJ Experience Santa Cruz",eventDate:"0001-01-06",isDefault:!0,hasImage:!0}],["evtb/event-item",{eventImage:s[1],eventImageAlt:"Cute Girls Rock Band Performance",eventDate:"0001-04-04",isDefault:!0,hasImage:!0}],["evtb/event-item",{eventImage:s[2],eventImageAlt:"Free Food Distribution At Mumbai",eventDate:"0001-06-08",isDefault:!0,hasImage:!0}]],renderAppender:()=>(0,e.createElement)(a.InnerBlocks.ButtonBlockAppender,null)})))},save:({attributes:t})=>{const{columns:n}=t,r=a.useBlockProps.save({className:"evtb-events-grid-container evtb-front-view",style:{"--columns":n}});return(0,e.createElement)("div",{...r},(0,e.createElement)(a.InnerBlocks.Content,null))}});const i=window.wp.element,d=window.wp.data,m=window.wp.hooks,v=window.wp.compose,b=JSON.parse('{"UU":"evtb/event-item"}');(0,t.registerBlockType)(b.UU,{edit:({attributes:e,setAttributes:o,clientId:s})=>{const{evtbBlockId:m,eventImage:v,eventImageAlt:b,eventDate:g,eventStartTime:u,eventEndTime:p,detailsBackgroundColor:k,isDefault:E,hasImage:B,mediaBlock:y}=e;(0,i.useEffect)(()=>{if(!m){const e=s.substring(0,8);o({evtbBlockId:e})}},[]),(0,i.useEffect)(()=>{g||E||o({eventDate:l()})},[]);const f=(0,d.useSelect)(e=>{const t=e("core/block-editor").getBlock(s)?.innerBlocks||[];if(t.find(e=>"core/image"===e.name))return!0;const a=t.find(e=>"core/group"===e.name&&e.attributes?.className?.includes("evtb-event-image-wrap"));return!!(a&&a.innerBlocks&&a.innerBlocks.find(e=>"core/image"===e.name))},[s]),w=e=>{if(e){const e=(0,t.createBlock)("core/group",{className:"evtb-event-image-wrap"},[(0,t.createBlock)("core/image",{className:"evtb-event-image-block"})]);(0,d.dispatch)("core/block-editor").insertBlocks(e,0,s),o({mediaBlock:!0,hasImage:!0}),setTimeout(()=>{const e=((0,d.select)("core/block-editor").getBlock(s)?.innerBlocks||[])[0];e&&e.innerBlocks&&e.innerBlocks[0]&&(0,d.dispatch)("core/block-editor").selectBlock(e.innerBlocks[0].clientId)},50)}else{const e=(0,d.select)("core/block-editor").getBlock(s)?.innerBlocks||[],t=e.find(e=>"core/group"===e.name&&e.attributes?.className?.includes("evtb-event-image-wrap"));if(t)(0,d.dispatch)("core/block-editor").removeBlock(t.clientId);else{const t=e.find(e=>"core/image"===e.name);t&&(0,d.dispatch)("core/block-editor").removeBlock(t.clientId)}o({mediaBlock:!1,eventImage:"",eventImageAlt:"",hasImage:!1})}},h=(0,a.useBlockProps)({className:"evtb-event-item"+(m?` evtb-block-${m}`:"")}),N=[{title:"Crazy DJ Experience Santa Cruz",time:"9:00 AM - 5:00 PM",location:"JW Marriott, Sector 35",price:"$25.00"},{title:"Cute Girls Rock Band Performance",time:"9:00 AM - 5:00 PM",location:"Club XYZ, Sector 17",price:"$20.00"},{title:"Free Food Distribution At Mumbai",time:"9:00 AM - 5:00 PM",location:"Food Corp. Mumbai, Ft. Line",price:"No Cost"}],I=E?b.includes("DJ")?N[0]:b.includes("Rock")?N[1]:b.includes("Food")?N[2]:null:null,C=`${c(u)} – ${c(p)}`,_=E&&I?[["core/group",{className:"evtb-event-image-wrap"},[["core/image",{url:v,alt:b,className:"evtb-event-image-block"}]]],["core/group",{className:"evtb-card-details"},[["evtb/event-date-badge",{eventDate:g,isDateSet:!0}],["core/group",{className:"evtb-event-detail"},[["core/paragraph",{className:"evtb-event-time",content:C,evtbStartTime:u,evtbEndTime:p,evtbIsTimeSet:!0}],["core/heading",{level:4,className:"evtb-event-title",content:I?.title||""}],["core/paragraph",{placeholder:(0,r.__)("Event Description","events"),className:"evtb-event-description"}],["core/paragraph",{className:"evtb-event-location",content:I?.location||""}],["core/group",{className:"evtb-price-read-more"},[["core/paragraph",{className:"evtb-event-price",content:I?.price||""}],["core/buttons",{},[["core/button",{text:"Read More",className:"evtb-event-read-more",url:""}]]]]]]]]]]:[["core/group",{className:"evtb-event-image-wrap"},[["core/image",{className:"evtb-event-image-block"}]]],["core/group",{className:"evtb-card-details"},[["evtb/event-date-badge",{eventDate:g,isDateSet:!0}],["core/group",{className:"evtb-event-detail"},[["core/paragraph",{placeholder:(0,r.__)("9:00 AM – 5:00 PM","events"),className:"evtb-event-time",evtbStartTime:u,evtbEndTime:p,evtbIsTimeSet:!1}],["core/heading",{level:4,placeholder:(0,r.__)("Event Title","events"),className:"evtb-event-title"}],["core/paragraph",{placeholder:(0,r.__)("Event Description","events"),className:"evtb-event-description"}],["core/paragraph",{placeholder:(0,r.__)("Event Location","events"),className:"evtb-event-location"}],["core/group",{className:"evtb-price-read-more"},[["core/paragraph",{placeholder:(0,r.__)("Event Price","events"),className:"evtb-event-price"}],["core/buttons",{},[["core/button",{text:(0,r.__)("Read More","events"),className:"evtb-event-read-more",url:""}]]]]]]]]]];return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(a.InspectorControls,null,(0,i.createElement)(n.PanelBody,{title:(0,r.__)("Event Settings","events")},(0,i.createElement)(n.PanelRow,null,(0,i.createElement)("div",{style:{width:"100%",marginTop:"16px"}},(0,i.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"}},(0,r.__)("Details Background Color","events")),(0,i.createElement)(a.ColorPalette,{value:k,onChange:e=>o({detailsBackgroundColor:e||"#ffffff"})}))))),(0,i.createElement)("div",{...h},(0,i.createElement)("div",{className:"evtb-event-card"},!f&&(0,i.createElement)("div",{className:"evtb-add-image-block"},(0,i.createElement)(n.Button,{isSmall:!0,isSecondary:!0,onClick:()=>w(!0)},(0,r.__)("Add Image Block","events"))),f&&(0,i.createElement)("div",{className:"evtb-add-image-block"},(0,i.createElement)(n.Button,{isSmall:!0,isSecondary:!0,onClick:()=>w(!1)},(0,r.__)("Remove Image Block","events"))),(0,i.createElement)("div",{className:"evtb-event-details",style:{"--evtb-details-bg":k||"#ffffff"}},(0,i.createElement)("div",{className:"evtb-event-details-inner"},(0,i.createElement)(a.InnerBlocks,{template:_,templateLock:!1,allowedBlocks:["core/group","core/image","evtb/event-date-badge","core/heading","core/paragraph","core/list","core/buttons","core/button"],renderAppender:!1}))))))},save:({attributes:e})=>{const{evtbBlockId:t,detailsBackgroundColor:n}=e,r=a.useBlockProps.save({className:"evtb-event-item"+(t?` evtb-block-${t}`:""),style:{"--evtb-details-bg":n||"#ffffff"}});return(0,i.createElement)("div",{...r},(0,i.createElement)("div",{className:"evtb-event-details-inner"},(0,i.createElement)(a.InnerBlocks.Content,null)))}}),(0,m.addFilter)("blocks.registerBlockType","evtb/paragraph-time-attributes",(e,t)=>"core/paragraph"!==t?e:{...e,attributes:{...e.attributes,evtbStartTime:{type:"string",default:"09:00"},evtbEndTime:{type:"string",default:"17:00"},evtbIsTimeSet:{type:"boolean",default:!1}}});const g=(0,v.createHigherOrderComponent)(e=>t=>{const{attributes:o,setAttributes:l,name:s}=t;if("core/paragraph"!==s||!o.className||!o.className.includes("evtb-event-time"))return(0,i.createElement)(e,t);const{evtbStartTime:m,evtbEndTime:v,evtbIsTimeSet:b}=o,g=(0,d.useSelect)(e=>{const{getBlockParents:a,getBlock:n}=e("core/block-editor"),r=a(t.clientId);for(let e of r){const t=n(e);if(t&&"evtb/event-item"===t.name)return{clientId:e,startTime:t.attributes.eventStartTime||"09:00",endTime:t.attributes.eventEndTime||"17:00"}}return null},[t.clientId]),u=g?.startTime||m,p=g?.endTime||v,k=(e,t)=>{const a=`${c(e)} – ${c(t)}`;l({content:a})};return(0,i.useEffect)(()=>{g&&b&&k(u,p)},[g?.startTime,g?.endTime]),(0,i.createElement)(i.Fragment,{},(0,i.createElement)(e,t),(0,i.createElement)(a.InspectorControls,{},(0,i.createElement)(n.PanelBody,{title:(0,r.__)("Time Settings","events"),className:"evtb-time-settings"},(0,i.createElement)("div",{className:"evtb-start-time-input"},(0,i.createElement)("strong",{},(0,r.__)("Start Time","events")),(0,i.createElement)("input",{type:"time",value:u,onChange:e=>{return t=e.target.value,l({evtbStartTime:t,evtbIsTimeSet:!0}),g&&(0,d.dispatch)("core/block-editor").updateBlockAttributes(g.clientId,{eventStartTime:t}),void k(t,p);var t},onClick:e=>{e.target.showPicker&&e.target.showPicker()}})),(0,i.createElement)("div",{className:"evtb-end-time-input"},(0,i.createElement)("strong",{},(0,r.__)("End Time","events")),(0,i.createElement)("input",{type:"time",value:p,onChange:e=>{return t=e.target.value,l({evtbEndTime:t,evtbIsTimeSet:!0}),g&&(0,d.dispatch)("core/block-editor").updateBlockAttributes(g.clientId,{eventEndTime:t}),void k(u,t);var t},onClick:e=>{e.target.showPicker&&e.target.showPicker()}})))))},"withTimeSettings");(0,m.addFilter)("editor.BlockEdit","evtb/paragraph-time-settings",g);const u=JSON.parse('{"UU":"evtb/event-date-badge"}');(0,t.registerBlockType)(u.UU,{edit:({attributes:t,setAttributes:c,context:s,clientId:m})=>{const{evtbBadgeId:v,eventDate:b,isDateSet:g,dateBadgeBackgroundColor:u,dateBadgeTextColor:p,borderBadgeColor:k,weekdayColor:E}=t;(0,i.useEffect)(()=>{if(!v){const e=m.substring(0,8);c({evtbBadgeId:e})}},[]),(0,i.useEffect)(()=>{b||s["evtb/eventDate"]||c({eventDate:l()})},[]);const B=s["evtb/eventDate"]||b||l(),y=(0,d.useSelect)(e=>{const{getBlockParents:t,getBlock:a}=e("core/block-editor"),n=t(m);for(let e of n){const t=a(e);if(t&&"evtb/event-item"===t.name)return e}return null},[m]);(0,i.useEffect)(()=>{s["evtb/eventDate"]&&s["evtb/eventDate"]!==b&&c({eventDate:s["evtb/eventDate"]})},[s["evtb/eventDate"]]);const f=(0,a.useBlockProps)({className:"evtb-event-date-badge-container"+(v?` evtb-badge-${v}`:""),style:{"--evtb-badge-bg":u,"--evtb-badge-text":p,"--evtb-badge-border":k,"--evtb-badge-weekday":E}}),w=(e=>{if(!e)return{day:"01",month:"Jan",year:"0001",weekday:"MON"};try{const t=new Date(e);return{day:(0,o.dateI18n)("d",t),month:(0,o.dateI18n)("M",t),year:(0,o.dateI18n)("Y",t),weekday:(0,o.dateI18n)("D",t).toUpperCase()}}catch(e){return{day:"01",month:"Jan",year:"0001",weekday:"MON"}}})(B);return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(a.InspectorControls,null,(0,e.createElement)(n.PanelBody,{className:"evtb-date-settings",title:(0,r.__)("Date Settings","events")},(0,e.createElement)("div",{style:{marginBottom:"15px"}},(0,e.createElement)("strong",null,(0,r.__)("Event Date","events")),(0,e.createElement)(n.DateTimePicker,{currentDate:B,onChange:e=>{c({eventDate:e,isDateSet:!0}),y&&(0,d.dispatch)("core/block-editor").updateBlockAttributes(y,{eventDate:e})},is12Hour:!0})),(0,e.createElement)("p",{style:{fontSize:"13px",color:"#FF0000",marginBottom:"10px"}},(0,e.createElement)("strong",null,(0,r.__)("Note:","events"))," ",(0,r.__)("To hide the year, simply set the year value to 0001 in the year section.","events"))),(0,e.createElement)(n.PanelBody,{title:(0,r.__)("Date Colors","events"),initialOpen:!1},(0,e.createElement)(n.PanelRow,null,(0,e.createElement)("div",{style:{width:"100%",marginTop:"16px"}},(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"}},(0,r.__)("Background Color","events")),(0,e.createElement)(a.ColorPalette,{value:u,onChange:e=>c({dateBadgeBackgroundColor:e||"#2667FF"})}))),(0,e.createElement)(n.PanelRow,null,(0,e.createElement)("div",{style:{width:"100%",marginTop:"16px"}},(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"}},(0,r.__)("Text Color","events")),(0,e.createElement)(a.ColorPalette,{value:p,onChange:e=>c({dateBadgeTextColor:e||"#ffffff"})}))),(0,e.createElement)(n.PanelRow,null,(0,e.createElement)("div",{style:{width:"100%",marginTop:"16px"}},(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"}},(0,r.__)("Border Color","events")),(0,e.createElement)(a.ColorPalette,{value:k,onChange:e=>c({borderBadgeColor:e||"#00000040"})}))),(0,e.createElement)(n.PanelRow,null,(0,e.createElement)("div",{style:{width:"100%",marginTop:"16px"}},(0,e.createElement)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"}},(0,r.__)("Weekday Color","events")),(0,e.createElement)(a.ColorPalette,{value:E,onChange:e=>c({weekdayColor:e||"#000000"})}))))),(0,e.createElement)("div",{...f},(0,e.createElement)("div",{className:"evtb-border-badge"},(0,e.createElement)("div",{className:"evtb-event-date-badge"},(0,e.createElement)("span",{className:"evtb-date-day"},w.day),(0,e.createElement)("span",{className:"evtb-date-month"},w.month),"0001"!==w.year&&(0,e.createElement)("span",{className:"evtb-date-year"},w.year))),(0,e.createElement)("span",{className:"evtb-date-weekday"},w.weekday)))},save:({attributes:t})=>{const{evtbBadgeId:n,eventDate:r,isDateSet:l,dateBadgeBackgroundColor:c,dateBadgeTextColor:s,borderBadgeColor:i,weekdayColor:d}=t,m=a.useBlockProps.save({className:"evtb-event-date-badge-container"+(n?` evtb-badge-${n}`:""),style:{"--evtb-badge-bg":c||"#2667FF","--evtb-badge-text":s||"#ffffff","--evtb-badge-border":i||"#00000040","--evtb-badge-weekday":d||"#000000"}}),v=(e=>{if(!e)return{day:"01",month:"Jan",year:"0001",weekday:"MON"};try{const t=new Date(e);return{day:(0,o.dateI18n)("d",t),month:(0,o.dateI18n)("M",t),year:(0,o.dateI18n)("Y",t),weekday:(0,o.dateI18n)("D",t).toUpperCase()}}catch(e){return{day:"01",month:"Jan",year:"0001",weekday:"MON"}}})(r);return(0,e.createElement)("div",{...m},(0,e.createElement)("div",{className:"evtb-border-badge"},(0,e.createElement)("div",{className:"evtb-event-date-badge"},(0,e.createElement)("span",{className:"evtb-date-day"},v.day),(0,e.createElement)("span",{className:"evtb-date-month"},v.month),"0001"!==v.year&&(0,e.createElement)("span",{className:"evtb-date-year"},v.year))),(0,e.createElement)("span",{className:"evtb-date-weekday"},v.weekday))}})})();