(()=>{"use strict";const e=window.React,t=window.wp.blocks,a=window.wp.blockEditor,n=window.wp.components,l=window.wp.i18n,r=window.wp.date,o=window.wp.element;(0,t.registerBlockType)("evt/events-grid",{title:(0,l.__)("Events Grid","events"),icon:"calendar-alt",category:"widgets",attributes:{columns:{type:"number",default:3}},edit:({attributes:t,setAttributes:r})=>{const{columns:o}=t,s=(0,a.useBlockProps)({className:"evt-events-grid-container",style:{"--columns":o}});return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(a.InspectorControls,null,(0,e.createElement)(n.PanelBody,{title:(0,l.__)("Grid Settings","events")},(0,e.createElement)(n.__experimentalNumberControl,{label:(0,l.__)("Columns","events"),value:o,onChange:e=>r({columns:parseInt(e)||3}),min:1,max:6}))),(0,e.createElement)("div",{...s},(0,e.createElement)(a.InnerBlocks,{allowedBlocks:["evt/event-item"],template:[["evt/event-item",{}],["evt/event-item",{}],["evt/event-item",{}]],renderAppender:()=>(0,e.createElement)(a.InnerBlocks.ButtonBlockAppender,null)})))},save:({attributes:t})=>{const{columns:n}=t,l=a.useBlockProps.save({className:"evt-events-grid-container",style:{"--columns":n}});return(0,e.createElement)("div",{...l},(0,e.createElement)(a.InnerBlocks.Content,null))}}),(0,t.registerBlockType)("evt/event-item",{title:(0,l.__)("Event Item","events"),icon:"calendar",category:"widgets",parent:["evt/events-grid"],attributes:{eventImage:{type:"string",default:""},eventImageAlt:{type:"string",default:""},eventDate:{type:"string",default:(()=>{const e=new Date;return(0,r.dateI18n)("Y-m-d",e)})()},detailsBackgroundColor:{type:"string",default:"#ffffff"},dateBadgeBackgroundColor:{type:"string",default:"#2667FF"},dateBadgeTextColor:{type:"string",default:"#ffffff"},borderBadgeColor:{type:"string",default:"#00000040"}},edit:({attributes:t,setAttributes:s,clientId:c})=>{const{eventImage:d,eventImageAlt:m,eventDate:i,detailsBackgroundColor:v,dateBadgeBackgroundColor:g,dateBadgeTextColor:u,borderBadgeColor:p}=t;(0,o.useEffect)(()=>{if(!d&&window.evtPluginData&&window.evtPluginData.images){const e=Object.values(window.evtPluginData.images);if(e.length>0){const t=e[Math.floor(Math.random()*e.length)];s({eventImage:t})}}},[]);const E=(0,a.useBlockProps)({className:"evt-event-item"}),y=(e=>{if(!e)return{day:"01",month:"Jan",weekday:"MON"};try{const t=new Date(e);return{day:(0,r.dateI18n)("d",t),month:(0,r.dateI18n)("M",t),weekday:(0,r.dateI18n)("D",t).toUpperCase()}}catch(e){return{day:"01",month:"Jan",weekday:"MON"}}})(i),_=[["core/heading",{level:4,placeholder:(0,l.__)("Event Title","events"),className:"evt-event-title",content:(0,l.__)("Event Title","events")}],["core/paragraph",{placeholder:(0,l.__)("Event Description","events"),className:"evt-event-description",content:(0,l.__)("Add your event description here...","events")}],["core/paragraph",{placeholder:(0,l.__)("Event Time","events"),className:"evt-event-time",content:(0,l.__)("9:00 AM - 5:00 PM","events")}],["core/paragraph",{placeholder:(0,l.__)("Event Location","events"),className:"evt-event-location",content:(0,l.__)("Event Location","events")}],["core/paragraph",{placeholder:(0,l.__)("Event Price","events"),className:"evt-event-price",content:(0,l.__)("$25.00","events")}],["core/buttons",{},[["core/button",{text:(0,l.__)("Read More","events"),className:"evt-event-read-more",backgroundColor:"vivid-cyan-blue",url:"#"}]]]];return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(a.InspectorControls,null,(0,e.createElement)(n.PanelBody,{title:(0,l.__)("Event Settings","events")},(0,e.createElement)("div",{style:{marginBottom:"15px"}},(0,e.createElement)("strong",null,(0,l.__)("Event Date","events")),(0,e.createElement)(n.DateTimePicker,{currentDate:i,onChange:e=>s({eventDate:e}),is12Hour:!0}))),(0,e.createElement)(n.PanelBody,{title:(0,l.__)("Event Image","events"),initialOpen:!1},(0,e.createElement)(a.MediaUploadCheck,null,(0,e.createElement)(a.MediaUpload,{onSelect:e=>{s({eventImage:e.url,eventImageAlt:e.alt||e.title})},allowedTypes:["image"],value:d,render:({open:t})=>(0,e.createElement)("div",null,d?(0,e.createElement)(e.Fragment,null,(0,e.createElement)("img",{src:d,alt:m,style:{width:"100%",marginBottom:"10px"}}),(0,e.createElement)(n.Button,{isSecondary:!0,onClick:t,style:{marginRight:"10px"}},(0,l.__)("Change Image","events")),(0,e.createElement)(n.Button,{isDestructive:!0,onClick:()=>s({eventImage:"",eventImageAlt:""})},(0,l.__)("Remove","events"))):(0,e.createElement)(n.Button,{isPrimary:!0,onClick:t},(0,l.__)("Upload Image","events")))}))),(0,e.createElement)(n.PanelBody,{title:(0,l.__)("Colors","events"),initialOpen:!1},(0,e.createElement)("p",null,(0,e.createElement)("strong",null,(0,l.__)("Details Background","events"))),(0,e.createElement)("input",{type:"color",value:v,onChange:e=>s({detailsBackgroundColor:e.target.value}),style:{width:"100%",height:"40px",marginBottom:"10px"}}),(0,e.createElement)("p",null,(0,e.createElement)("strong",null,(0,l.__)("Date Badge Background","events"))),(0,e.createElement)("input",{type:"color",value:g,onChange:e=>s({dateBadgeBackgroundColor:e.target.value}),style:{width:"100%",height:"40px",marginBottom:"10px"}}),(0,e.createElement)("p",null,(0,e.createElement)("strong",null,(0,l.__)("Date Badge Text","events"))),(0,e.createElement)("input",{type:"color",value:u,onChange:e=>s({dateBadgeTextColor:e.target.value}),style:{width:"100%",height:"40px",marginBottom:"10px"}}),(0,e.createElement)("p",null,(0,e.createElement)("strong",null,(0,l.__)("Border Color","events"))),(0,e.createElement)("input",{type:"color",value:p,onChange:e=>s({borderBadgeColor:e.target.value}),style:{width:"100%",height:"40px",marginBottom:"10px"}}))),(0,e.createElement)("div",{...E},(0,e.createElement)("div",{className:"evt-event-card"},d&&(0,e.createElement)("div",{className:"evt-event-image"},(0,e.createElement)("img",{src:d,alt:m})),(0,e.createElement)("div",{className:"evt-event-details",style:{backgroundColor:v}},(0,e.createElement)("div",{className:"evt-event-date-badge-container"},(0,e.createElement)("div",{className:"evt-border-badge",style:{borderColor:p}},(0,e.createElement)("div",{className:"evt-event-date-badge",style:{backgroundColor:g,color:u}},(0,e.createElement)("span",{className:"evt-date-day"},y.day),(0,e.createElement)("span",{className:"evt-date-month"},y.month))),(0,e.createElement)("span",{className:"evt-date-weekday"},y.weekday)),(0,e.createElement)("div",{className:"evt-event-details-inner"},(0,e.createElement)(a.InnerBlocks,{template:_,templateLock:!1,allowedBlocks:["core/heading","core/paragraph","core/list","core/buttons","core/button","core/image"]}))))))},save:({attributes:t})=>{const{eventImage:n,eventImageAlt:l,eventDate:o,detailsBackgroundColor:s,dateBadgeBackgroundColor:c,dateBadgeTextColor:d,borderBadgeColor:m}=t,i=a.useBlockProps.save({className:"evt-event-item"}),v=(e=>{if(!e)return{day:"01",month:"Jan",weekday:"MON"};try{const t=new Date(e);return{day:(0,r.dateI18n)("d",t),month:(0,r.dateI18n)("M",t),weekday:(0,r.dateI18n)("D",t).toUpperCase()}}catch(e){return{day:"01",month:"Jan",weekday:"MON"}}})(o);return(0,e.createElement)("div",{...i},(0,e.createElement)("div",{className:"evt-event-card"},n&&(0,e.createElement)("div",{className:"evt-event-image"},(0,e.createElement)("img",{src:n,alt:l})),(0,e.createElement)("div",{className:"evt-event-details",style:{backgroundColor:s}},(0,e.createElement)("div",{className:"evt-event-date-badge-container"},(0,e.createElement)("div",{className:"evt-border-badge",style:{borderColor:m}},(0,e.createElement)("div",{className:"evt-event-date-badge",style:{backgroundColor:c,color:d}},(0,e.createElement)("span",{className:"evt-date-day"},v.day),(0,e.createElement)("span",{className:"evt-date-month"},v.month))),(0,e.createElement)("span",{className:"evt-date-weekday"},v.weekday)),(0,e.createElement)("div",{className:"evt-event-details-inner"},(0,e.createElement)(a.InnerBlocks.Content,null)))))}})})();