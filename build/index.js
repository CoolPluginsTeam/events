(()=>{"use strict";const e=window.wp.blocks,t=window.wp.blockEditor,a=window.wp.components,n=window.wp.i18n,r=window.wp.element,o=window.wp.data,s=window.wp.date,c=()=>{const e=new Date;return(0,s.dateI18n)("Y-m-d",e)},l=e=>{if(!e)return"";const[t,a]=e.split(":");let n=parseInt(t);const r=n>=12?"PM":"AM";return n%=12,n=n||12,`${n}:${a} ${r}`},i=JSON.parse('{"UU":"evtb/events-grid"}'),d=window.ReactJSXRuntime;(0,e.registerBlockType)(i.UU,{title:(0,n.__)("Events Grid","events-block"),edit:({attributes:s,setAttributes:c,clientId:l})=>{const{columns:i,hideYear:v,hidePastEvents:m}=s,b=(0,t.useBlockProps)({className:"evtb-events-grid-container",style:{"--grid-columns":i}}),{insertBlocks:g,updateBlockAttributes:p}=(0,o.useDispatch)("core/block-editor"),u=(0,o.useSelect)(e=>e("core/block-editor").getBlock(l)?.innerBlocks||[],[l]),h=window.evtbPluginData||{},k=h.images?[h.images.crazyDJ||"",h.images.rockBand||"",h.images.foodDistribution||""]:["","",""];return(0,r.useEffect)(()=>{if(0===u.length&&k[0]){const t=[{eventImage:k[0],eventImageAlt:"Crazy DJ Experience Santa Cruz",eventDate:"2026-01-06",eventStartTime:"09:00",eventEndTime:"17:00",isDefault:!0,hasImage:!0},{eventImage:k[1],eventImageAlt:"Cute Girls Rock Band Performance",eventDate:"2026-04-04",eventStartTime:"09:00",eventEndTime:"17:00",isDefault:!0,hasImage:!0},{eventImage:k[2],eventImageAlt:"Free Food Distribution At Mumbai",eventDate:"2026-06-08",eventStartTime:"09:00",eventEndTime:"17:00",isDefault:!0,hasImage:!0}],a=t.map(t=>(0,e.createBlock)("evtb/event-item",t));try{g(a,0,l,!1),setTimeout(()=>{((0,o.select)("core/block-editor").getBlock(l)?.innerBlocks||[]).forEach((e,a)=>{t[a]&&p(e.clientId,t[a])})},100)}catch(e){console.error("âŒ Error inserting blocks:",e)}}},[u.length,k[0],g,p]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(t.InspectorControls,{children:(0,d.jsxs)(a.PanelBody,{title:(0,n.__)("Grid Settings","events"),children:[(0,d.jsx)(a.__experimentalNumberControl,{label:(0,n.__)("Columns","events"),value:i,onChange:e=>c({columns:parseInt(e)||2}),min:1,max:3,help:(0,n.__)("Number of columns in the grid (1-3)","evtb"),__next40pxDefaultSize:!0}),(0,d.jsx)(a.ToggleControl,{label:(0,n.__)("Hide Year (All Events)","events"),checked:v,onChange:e=>c({hideYear:e}),help:(0,n.__)("Toggle to hide or show the year in all event date badges","events"),__nextHasNoMarginBottom:!0}),(0,d.jsx)(a.ToggleControl,{label:(0,n.__)("Hide Past Events","events"),checked:m,onChange:e=>c({hidePastEvents:e}),help:(0,n.__)("Automatically hide events that have passed","events"),__nextHasNoMarginBottom:!0})]})}),(0,d.jsx)("div",{...b,children:(0,d.jsx)(t.InnerBlocks,{allowedBlocks:["evtb/event-item"],template:[["evtb/event-item",{eventImage:k[0],eventImageAlt:"Crazy DJ Experience Santa Cruz",eventDate:"2026-01-06",isDefault:!0,hasImage:!0}],["evtb/event-item",{eventImage:k[1],eventImageAlt:"Cute Girls Rock Band Performance",eventDate:"2026-04-04",isDefault:!0,hasImage:!0}],["evtb/event-item",{eventImage:k[2],eventImageAlt:"Free Food Distribution At Mumbai",eventDate:"2026-06-08",isDefault:!0,hasImage:!0}]],renderAppender:()=>(0,d.jsx)(t.InnerBlocks.ButtonBlockAppender,{})})})]})},save:({attributes:e})=>{const{columns:a}=e,n=t.useBlockProps.save({className:"evtb-events-grid-container evtb-front-view",style:{"--columns":a}});return(0,d.jsx)("div",{...n,children:(0,d.jsx)(t.InnerBlocks.Content,{})})}});const v=window.wp.hooks,m=window.wp.compose,b=JSON.parse('{"UU":"evtb/event-item"}');(0,e.registerBlockType)(b.UU,{title:(0,n.__)("Event Item","events-block"),edit:({attributes:s,setAttributes:i,clientId:v,context:m})=>{const{evtbBlockId:b,eventImage:g,eventImageAlt:p,eventDate:u,eventStartTime:h,eventEndTime:k,detailsBackgroundColor:B,isDefault:x,hasImage:f,mediaBlock:_,contentPopulated:D}=s;(0,r.useEffect)(()=>{if(!b){const e=v.substring(0,8);i({evtbBlockId:e})}},[]),(0,r.useEffect)(()=>{u||x||i({eventDate:c()})},[]);const N=(0,o.useSelect)(e=>{const t=e("core/block-editor").getBlock(v)?.innerBlocks||[];if(t.find(e=>"core/image"===e.name))return!0;const a=t.find(e=>"core/group"===e.name&&e.attributes?.className?.includes("evtb-event-image-wrap"));return!!(a&&a.innerBlocks&&a.innerBlocks.find(e=>"core/image"===e.name))},[v]),y=t=>{if(t){const t=(0,e.createBlock)("core/group",{className:"evtb-event-image-wrap"},[(0,e.createBlock)("core/image",{className:"evtb-event-image-block"})]);(0,o.dispatch)("core/block-editor").insertBlocks(t,0,v),i({mediaBlock:!0,hasImage:!0}),setTimeout(()=>{const e=((0,o.select)("core/block-editor").getBlock(v)?.innerBlocks||[])[0];e&&e.innerBlocks&&e.innerBlocks[0]&&(0,o.dispatch)("core/block-editor").selectBlock(e.innerBlocks[0].clientId)},50)}else{const e=(0,o.select)("core/block-editor").getBlock(v)?.innerBlocks||[],t=e.find(e=>"core/group"===e.name&&e.attributes?.className?.includes("evtb-event-image-wrap"));if(t)(0,o.dispatch)("core/block-editor").removeBlock(t.clientId);else{const t=e.find(e=>"core/image"===e.name);t&&(0,o.dispatch)("core/block-editor").removeBlock(t.clientId)}i({mediaBlock:!1,eventImage:"",eventImageAlt:"",hasImage:!1})}};let w=!1;if(m["evtb/hidePastEvents"]&&u)try{const e=new Date;let t=new Date(u);if(k){const[e,a]=k.split(":");t.setHours(e,a),h&&k<h&&t.setDate(t.getDate()+1)}else t.setHours(23,59,59);t<e&&(w=!0)}catch(e){}const I=(0,t.useBlockProps)({className:"evtb-event-item"+(b?` evtb-block-${b}`:""),style:w?{opacity:.6,filter:"grayscale(1)"}:{}}),j=[{title:"Crazy DJ Experience Santa Cruz",time:"9:00 AM - 5:00 PM",location:"JW Marriott, Sector 35",price:"$25.00"},{title:"Cute Girls Rock Band Performance",time:"9:00 AM - 5:00 PM",location:"Club XYZ, Sector 17",price:"$20.00"},{title:"Free Food Distribution At Mumbai",time:"9:00 AM - 5:00 PM",location:"Food Corp. Mumbai, Ft. Line",price:"No Cost"}],C=()=>x?p.includes("DJ")?j[0]:p.includes("Rock")?j[1]:p.includes("Food")?j[2]:null:null,T=C(),E=`${l(h)} â€“ ${l(k)}`,{insertBlocks:S,removeBlocks:P}=(0,o.useDispatch)("core/block-editor"),A=(0,o.useSelect)(e=>e("core/block-editor").getBlock(v)?.innerBlocks||[],[v]);(0,r.useEffect)(()=>{if(void 0!==x&&void 0!==g&&x&&!D&&g&&S&&P){const t=setTimeout(()=>{const t=C();if(t){if(A.length>0){const e=A.map(e=>e.clientId);P(e,!1)}const a=`${l(h)} â€“ ${l(k)}`;console.log("ðŸ—ï¸ Creating date badge with:",{eventDate:u,isDateSet:!0});const r=[(0,e.createBlock)("core/group",{className:"evtb-event-image-wrap"},[(0,e.createBlock)("core/image",{url:g,alt:p,className:"evtb-event-image-block"})]),(0,e.createBlock)("core/group",{className:"evtb-card-details"},[(0,e.createBlock)("evtb/event-date-badge",{eventDate:u,isDateSet:!0}),(0,e.createBlock)("core/group",{className:"evtb-event-detail"},[(0,e.createBlock)("core/paragraph",{className:"evtb-event-time",content:a,evtbStartTime:h,evtbEndTime:k,evtbIsTimeSet:!0}),(0,e.createBlock)("core/heading",{level:4,className:"evtb-event-title",content:t.title}),(0,e.createBlock)("core/paragraph",{placeholder:(0,n.__)("Event Description","events"),className:"evtb-event-description"}),(0,e.createBlock)("core/paragraph",{className:"evtb-event-location",content:t.location}),(0,e.createBlock)("core/group",{className:"evtb-price-read-more"},[(0,e.createBlock)("core/paragraph",{className:"evtb-event-price",content:t.price}),(0,e.createBlock)("core/buttons",{},[(0,e.createBlock)("core/button",{text:"Read More",className:"evtb-event-read-more",url:""})])])])])];try{S(r,0,v,!1),i({contentPopulated:!0})}catch(e){console.error("âŒ Error inserting blocks:",e)}}},150);return()=>clearTimeout(t)}},[x,D,g,p,S,P]);const M=x&&T?[["core/group",{className:"evtb-event-image-wrap"},[["core/image",{url:g,alt:p,className:"evtb-event-image-block"}]]],["core/group",{className:"evtb-card-details"},[["evtb/event-date-badge",{eventDate:u,isDateSet:!0}],["core/group",{className:"evtb-event-detail"},[["core/paragraph",{className:"evtb-event-time",content:E,evtbStartTime:h,evtbEndTime:k,evtbIsTimeSet:!0}],["core/heading",{level:4,className:"evtb-event-title",content:T?.title||""}],["core/paragraph",{placeholder:(0,n.__)("Event Description","events"),className:"evtb-event-description"}],["core/paragraph",{className:"evtb-event-location",content:T?.location||""}],["core/group",{className:"evtb-price-read-more"},[["core/paragraph",{className:"evtb-event-price",content:T?.price||""}],["core/buttons",{},[["core/button",{text:"Read More",className:"evtb-event-read-more",url:""}]]]]]]]]]]:[["core/group",{className:"evtb-event-image-wrap"},[["core/image",{className:"evtb-event-image-block"}]]],["core/group",{className:"evtb-card-details"},[["evtb/event-date-badge",{eventDate:u,isDateSet:!0}],["core/group",{className:"evtb-event-detail"},[["core/paragraph",{placeholder:(0,n.__)("9:00 AM â€“ 5:00 PM","events"),className:"evtb-event-time",evtbStartTime:h,evtbEndTime:k,evtbIsTimeSet:!1}],["core/heading",{level:4,placeholder:(0,n.__)("Event Title","events"),className:"evtb-event-title"}],["core/paragraph",{placeholder:(0,n.__)("Event Description","events"),className:"evtb-event-description"}],["core/paragraph",{placeholder:(0,n.__)("Event Location","events"),className:"evtb-event-location"}],["core/group",{className:"evtb-price-read-more"},[["core/paragraph",{placeholder:(0,n.__)("Event Price","events"),className:"evtb-event-price"}],["core/buttons",{},[["core/button",{text:(0,n.__)("Read More","events"),className:"evtb-event-read-more",url:""}]]]]]]]]]];return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(t.InspectorControls,{children:(0,d.jsx)(a.PanelBody,{title:(0,n.__)("Event Settings","events"),children:(0,d.jsx)(a.PanelRow,{children:(0,d.jsxs)("div",{style:{width:"100%",marginTop:"16px"},children:[(0,d.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:(0,n.__)("Details Background Color","events")}),(0,d.jsx)(t.ColorPalette,{value:B,onChange:e=>i({detailsBackgroundColor:e||"#ffffff"})})]})})})}),(0,d.jsx)("div",{...I,children:(0,d.jsxs)("div",{className:"evtb-event-card",children:[!N&&(0,d.jsx)("div",{className:"evtb-add-image-block",children:(0,d.jsx)(a.Button,{isSmall:!0,isSecondary:!0,onClick:()=>y(!0),children:(0,n.__)("Add Image Block","events")})}),N&&(0,d.jsx)("div",{className:"evtb-add-image-block",children:(0,d.jsx)(a.Button,{isSmall:!0,isSecondary:!0,onClick:()=>y(!1),children:(0,n.__)("Remove Image Block","events")})}),(0,d.jsx)("div",{className:"evtb-event-details",style:{"--evtb-details-bg":B||"#ffffff"},children:(0,d.jsx)("div",{className:"evtb-event-details-inner",children:(0,d.jsx)(t.InnerBlocks,{template:M,templateLock:!1,allowedBlocks:["core/group","core/image","evtb/event-date-badge","core/heading","core/paragraph","core/list","core/buttons","core/button"],renderAppender:!1})})})]})})]})},save:({attributes:e})=>{const{evtbBlockId:a,detailsBackgroundColor:n}=e,r=t.useBlockProps.save({className:"evtb-event-item"+(a?` evtb-block-${a}`:""),style:{"--evtb-details-bg":n||"#ffffff"}});return(0,d.jsx)("div",{...r,children:(0,d.jsx)("div",{className:"evtb-event-card",children:(0,d.jsx)("div",{className:"evtb-event-details",children:(0,d.jsx)("div",{className:"evtb-event-details-inner",children:(0,d.jsx)(t.InnerBlocks.Content,{})})})})})}}),(0,v.addFilter)("blocks.registerBlockType","evtb/paragraph-time-attributes",(e,t)=>"core/paragraph"!==t?e:{...e,attributes:{...e.attributes,evtbStartTime:{type:"string",default:"09:00"},evtbEndTime:{type:"string",default:"17:00"},evtbIsTimeSet:{type:"boolean",default:!1}}});const g=(0,m.createHigherOrderComponent)(e=>s=>{const{attributes:c,setAttributes:i,name:d}=s;if("core/paragraph"!==d||!c.className||!c.className.includes("evtb-event-time"))return(0,r.createElement)(e,s);const{evtbStartTime:v,evtbEndTime:m,evtbIsTimeSet:b}=c,g=(0,o.useSelect)(e=>{const{getBlockParents:t,getBlock:a}=e("core/block-editor"),n=t(s.clientId);for(let e of n){const t=a(e);if(t&&"evtb/event-item"===t.name)return{clientId:e,startTime:t.attributes.eventStartTime||"09:00",endTime:t.attributes.eventEndTime||"17:00"}}return null},[s.clientId]),p=g?.startTime||v,u=g?.endTime||m,h=(e,t)=>{const a=`${l(e)} â€“ ${l(t)}`;i({content:a})};return(0,r.useEffect)(()=>{g&&b&&h(p,u)},[g?.startTime,g?.endTime]),(0,r.createElement)(r.Fragment,{},(0,r.createElement)(e,s),(0,r.createElement)(t.InspectorControls,{},(0,r.createElement)(a.PanelBody,{title:(0,n.__)("Time Settings","events"),className:"evtb-time-settings"},(0,r.createElement)("div",{className:"evtb-start-time-input"},(0,r.createElement)("strong",{},(0,n.__)("Start Time","events")),(0,r.createElement)("input",{type:"time",value:p,onChange:e=>{return t=e.target.value,i({evtbStartTime:t,evtbIsTimeSet:!0}),g&&(0,o.dispatch)("core/block-editor").updateBlockAttributes(g.clientId,{eventStartTime:t}),void h(t,u);var t},onClick:e=>{e.target.showPicker&&e.target.showPicker()}})),(0,r.createElement)("div",{className:"evtb-end-time-input"},(0,r.createElement)("strong",{},(0,n.__)("End Time","events")),(0,r.createElement)("input",{type:"time",value:u,onChange:e=>{return t=e.target.value,i({evtbEndTime:t,evtbIsTimeSet:!0}),g&&(0,o.dispatch)("core/block-editor").updateBlockAttributes(g.clientId,{eventEndTime:t}),void h(p,t);var t},onClick:e=>{e.target.showPicker&&e.target.showPicker()}})))))},"withTimeSettings");(0,v.addFilter)("editor.BlockEdit","evtb/paragraph-time-settings",g);const p=JSON.parse('{"UU":"evtb/event-date-badge"}');(0,e.registerBlockType)(p.UU,{title:(0,n.__)("Event Date Badge","events-block"),edit:({attributes:e,setAttributes:l,context:i,clientId:v})=>{const{evtbBadgeId:m,eventDate:b,isDateSet:g,dateBadgeBackgroundColor:p,dateBadgeTextColor:u,borderBadgeColor:h,weekdayColor:k,hideYear:B}=e;(0,r.useEffect)(()=>{if(!m){const e=v.substring(0,8);l({evtbBadgeId:e})}},[]),(0,r.useEffect)(()=>{b||i["evtb/eventDate"]||l({eventDate:c()})},[]);const x=i["evtb/eventDate"]||b||c();console.log("ðŸ“… Date Badge Debug:",{eventDate:b,contextDate:i["evtb/eventDate"],parentDate:x,isDateSet:g});const f=(0,o.useSelect)(e=>{const{getBlockParents:t,getBlock:a}=e("core/block-editor"),n=t(v);for(let e of n){const t=a(e);if(t&&"evtb/event-item"===t.name)return e}return null},[v]);(0,r.useEffect)(()=>{i["evtb/eventDate"]&&i["evtb/eventDate"]!==b&&l({eventDate:i["evtb/eventDate"]})},[i["evtb/eventDate"]]),(0,r.useEffect)(()=>{void 0!==i["evtb/hideYear"]&&i["evtb/hideYear"]!==B&&l({hideYear:i["evtb/hideYear"]})},[i["evtb/hideYear"]]);const _=(0,t.useBlockProps)({className:"evtb-event-date-badge-container"+(m?` evtb-badge-${m}`:""),style:{"--evtb-badge-bg":p,"--evtb-badge-text":u,"--evtb-badge-border":h,"--evtb-badge-weekday":k}}),D=(e=>{if(!e)return{day:"01",month:"Jan",year:"0001",weekday:"MON"};try{const t=new Date(e);return{day:(0,s.dateI18n)("d",t),month:(0,s.dateI18n)("M",t),year:(0,s.dateI18n)("Y",t),weekday:(0,s.dateI18n)("D",t).toUpperCase()}}catch(e){return{day:"01",month:"Jan",year:"0001",weekday:"MON"}}})(x);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(t.InspectorControls,{children:[(0,d.jsx)(a.PanelBody,{className:"evtb-date-settings",title:(0,n.__)("Date Settings","events"),children:(0,d.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,d.jsx)("strong",{children:(0,n.__)("Event Date","events")}),(0,d.jsx)("div",{style:{margin:"10px 0"},children:(0,d.jsx)(a.ToggleControl,{label:(0,n.__)("Hide Year","events"),checked:B,onChange:e=>l({hideYear:e}),help:(0,n.__)("Toggle to hide or show the year in the date badge","events"),__nextHasNoMarginBottom:!0})}),(0,d.jsx)(a.DateTimePicker,{currentDate:x,onChange:e=>{l({eventDate:e,isDateSet:!0}),f&&(0,o.dispatch)("core/block-editor").updateBlockAttributes(f,{eventDate:e})},is12Hour:!0})]})}),(0,d.jsxs)(a.PanelBody,{title:(0,n.__)("Date Colors","events"),initialOpen:!1,children:[(0,d.jsx)(a.PanelRow,{children:(0,d.jsxs)("div",{style:{width:"100%",marginTop:"16px"},children:[(0,d.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:(0,n.__)("Background Color","events")}),(0,d.jsx)(t.ColorPalette,{value:p,onChange:e=>l({dateBadgeBackgroundColor:e||"#2667FF"})})]})}),(0,d.jsx)(a.PanelRow,{children:(0,d.jsxs)("div",{style:{width:"100%",marginTop:"16px"},children:[(0,d.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:(0,n.__)("Text Color","events")}),(0,d.jsx)(t.ColorPalette,{value:u,onChange:e=>l({dateBadgeTextColor:e||"#ffffff"})})]})}),(0,d.jsx)(a.PanelRow,{children:(0,d.jsxs)("div",{style:{width:"100%",marginTop:"16px"},children:[(0,d.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:(0,n.__)("Border Color","events")}),(0,d.jsx)(t.ColorPalette,{value:h,onChange:e=>l({borderBadgeColor:e||"#00000040"})})]})}),(0,d.jsx)(a.PanelRow,{children:(0,d.jsxs)("div",{style:{width:"100%",marginTop:"16px"},children:[(0,d.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:(0,n.__)("Weekday Color","events")}),(0,d.jsx)(t.ColorPalette,{value:k,onChange:e=>l({weekdayColor:e||"#000000"})})]})})]})]}),(0,d.jsxs)("div",{..._,children:[(0,d.jsx)("div",{className:"evtb-border-badge",children:(0,d.jsxs)("div",{className:"evtb-event-date-badge",children:[(0,d.jsx)("span",{className:"evtb-date-day",children:D.day}),(0,d.jsx)("span",{className:"evtb-date-month",children:D.month}),!B&&"0001"!==D.year&&(0,d.jsx)("span",{className:"evtb-date-year",children:D.year})]})}),(0,d.jsx)("span",{className:"evtb-date-weekday",children:D.weekday})]})]})},save:()=>null})})();